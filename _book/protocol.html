<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>协议 | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    
    <link rel="prev" href="./index.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="1" data-chapter-title="协议" data-filepath="protocol.md" data-basepath="." data-revision="Sun Apr 09 2017 23:14:25 GMT+0800 (CST)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="1" data-path="protocol.html">
            
                
                    <a href="./protocol.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        协议
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h3 id="&#x4ECB;&#x7ECD;">&#x4ECB;&#x7ECD;</h3>
<p>&#x6B64;&#x6587;&#x6863;&#x6DB5;&#x76D6;&#x4E86;Kafka 0.8&#x53CA;&#x4E4B;&#x524D;&#x7248;&#x672C;&#x7684;&#x901A;&#x8BAF;&#x534F;&#x8BAE;&#x5B9E;&#x73B0;&#x3002;&#x5176;&#x76EE;&#x7684;&#x662F;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x7684;&#x53EF;&#x8BF7;&#x6C42;&#x7684;&#x534F;&#x8BAE;&#x53CA;&#x5176;&#x4E8C;&#x8FDB;&#x5236;&#x683C;&#x5F0F;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x6B63;&#x786E;&#x4F7F;&#x7528;&#x4ED6;&#x4EEC;&#x6765;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x901A;&#x8BAF;&#x534F;&#x8BAE;&#x6587;&#x6863;&#x3002;&#x672C;&#x6587;&#x5047;&#x8BBE;&#x60A8;&#x5DF2;&#x7ECF;&#x4E86;&#x89E3;&#x4E86;Kafka&#x57FA;&#x672C;&#x7684;&#x8BBE;&#x8BA1;&#x4EE5;&#x53CA;&#x672F;&#x8BED;&#x3002;</p>
<p>0.7&#x548C;&#x66F4;&#x65E9;&#x7684;&#x7248;&#x672C;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x534F;&#x8BAE;&#x4E0E;&#x6B64;&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#xFF08;&#x5E0C;&#x671B;&#xFF09;&#x901A;&#x8FC7;&#x4E00;&#x6B21;&#x6027;&#x5730;&#x65A9;&#x65AD;&#x517C;&#x5BB9;&#x6027;&#xFF0C;&#x4EE5;&#x4FBF;&#x6E05;&#x7406;&#x539F;&#x6709;&#x8BBE;&#x8BA1;&#x4E0A;&#x7684;&#x6C89;&#x75B4;&#xFF0C;&#x5E76;&#x4E14;&#x6CDB;&#x5316;&#x4E00;&#x4E9B;&#x6982;&#x5FF5;&#x3002;</p>
<h3 id="&#x6982;&#x8FF0;">&#x6982;&#x8FF0;</h3>
<p>Kafka &#x534F;&#x8BAE;&#x76F8;&#x5BF9;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x4EC5;&#x4EC5;&#x53EA;&#x6709;&#x516D;&#x7C7B;&#x6838;&#x5FC3;&#x4EA4;&#x4E92; API</p>
<ul>
<li>Metadata - &#x63CF;&#x8FF0;&#x5F53;&#x524D;&#x5B58;&#x5728;&#x7684; broker, &#x5305;&#x62EC;&#x5B83;&#x4EEC;&#x7684; host &#x548C;&#x7AEF;&#x53E3;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x542B;&#x5206;&#x533A;&#x548C;&#x8282;&#x70B9;&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;</li>
<li>Send - &#x53D1;&#x9001;&#x6D88;&#x606F;&#x5230; broker</li>
<li>Fetch - &#x4ECE; broker &#x4E2D;&#x83B7;&#x53D6;&#x6D88;&#x606F;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x3001;&#x83B7;&#x53D6;&#x96C6;&#x7FA4; meta &#x4FE1;&#x606F;&#x3001;&#x83B7;&#x53D6; offset &#x4FE1;&#x606F;</li>
<li>Offsets - &#x83B7;&#x53D6;&#x7ED9;&#x5B9A; topic &#x5206;&#x533A;&#x5BF9;&#x5E94;&#x7684;&#x5B58;&#x5728;&#x7684; offset &#x4FE1;&#x606F;</li>
<li>Offset Commit - &#x63D0;&#x4EA4;&#x4E00;&#x4E2A;&#x6D88;&#x8D39;&#x5206;&#x7EC4;&#x5BF9;&#x5E94;&#x7684; offset</li>
<li>Offset Fetch - &#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x6D88;&#x8D39;&#x5206;&#x7EC4;&#x5BF9;&#x5E94;&#x7684; offset</li>
</ul>
<p>&#x6BCF;&#x4E2A;&#x7C7B;&#x578B;&#x5C06;&#x5728;&#x4E0B;&#x9762;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;&#x3002;&#x5E76;&#x4E14;&#x5728; 0.9 &#x4EE5;&#x540E; kafka &#x589E;&#x52A0;&#x6D88;&#x8D39;&#x7EC4;&#x7BA1;&#x7406;&#x529F;&#x80FD;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF; API &#x7531;5&#x4E2A;&#x8BF7;&#x6C42;&#x7EC4;&#x6210;&#xFF1A;</p>
<ul>
<li>GroupCoordinator - &#x5206;&#x914D;&#x4E00;&#x4E2A;&#x7EC4;&#x7684;&#x5F53;&#x524D;&#x534F;&#x8C03;&#x5668;</li>
<li>JoinGroup - &#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x7EC4;&#xFF0C;&#x5982;&#x679C;&#x5176;&#x4E0D;&#x5B58;&#x5728;&#x8FD9;&#x521B;&#x5EFA;</li>
<li>SyncGroup - &#x540C;&#x6B65;&#x7EC4;&#x5185;&#x6210;&#x5458;&#x7684;&#x6240;&#x6709;&#x72B6;&#x6001;&#x503C; (&#x4F8B; &#x6D88;&#x8D39;&#x8005;&#x5206;&#x914D;&#x5206;&#x533A;)</li>
<li>Heartbeat - &#x4FDD;&#x6301;&#x4E00;&#x4E2A;&#x6D88;&#x8D39;&#x6210;&#x5458;&#x5728;&#x6539;&#x7EC4;&#x5185;&#x7684;&#x5FC3;&#x8DF3;</li>
<li>LeaveGroup - &#x76F4;&#x63A5;&#x79BB;&#x5F00;&#x4E00;&#x4E2A;&#x7EC4;</li>
</ul>
<p>&#x6700;&#x540E;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x7BA1;&#x7406;&#x7AEF;&#x7684; API &#x63A5;&#x53E3;&#xFF0C;&#x7528;&#x6765;&#x76D1;&#x63A7;&#x3001;&#x7BA1;&#x7406; kafka &#x96C6;&#x7FA4;</p>
<ul>
<li>DescribeGroups - &#x7528;&#x6765;&#x68C0;&#x67E5;&#x5F53;&#x524D;&#x7EC4;&#x6210;&#x5458;&#x7684;&#x72B6;&#x6001; (&#x4F8B; &#x5F53;&#x524D;&#x6D88;&#x8D39;&#x8005;&#x5206;&#x533A;&#x5206;&#x914D;&#x60C5;&#x51B5;)</li>
<li>ListGroups - &#x5217;&#x51FA;&#x901A;&#x8FC7; broker &#x7BA1;&#x7406;&#x7684;&#x6D88;&#x8D39;&#x7EC4;&#x4FE1;&#x606F;</li>
</ul>
<h3 id="&#x8D77;&#x6B65;">&#x8D77;&#x6B65;</h3>
<h4 id="&#x7F51;&#x7EDC;">&#x7F51;&#x7EDC;</h4>
<p>Kafka &#x4F7F;&#x7528;&#x7684;&#x662F; TCP &#x4E0A;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x534F;&#x8BAE;&#xFF0C;&#x534F;&#x8BAE;&#x5B9A;&#x4E49;&#x4E86;&#x6240;&#x6709;&#x7684; API &#x7684;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x7ED3;&#x6784;&#x3002;&#x6240;&#x6709;&#x7684;&#x6D88;&#x606F;&#x6CA1;&#x6709;&#x5927;&#x5C0F;&#x9650;&#x5236;&#x5E76;&#x4E14;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x539F;&#x59CB;&#x7C7B;&#x578B;&#x7EC4;&#x6210;</p>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x521D;&#x59CB;&#x5316;&#x8FDE;&#x63A5;&#xFF0C;&#x7136;&#x540E;&#x5199;&#x5165;&#x8BF7;&#x6C42;&#x7684;&#x6D88;&#x606F;&#x5E8F;&#x5217;&#x5E76;&#x4E14;&#x8BFB;&#x53D6;&#x5173;&#x8054;&#x7684;&#x54CD;&#x5E94;&#x6D88;&#x606F;&#x5E8F;&#x5217;&#xFF0C;&#x8FDE;&#x63A5;&#x548C;&#x65AD;&#x5F00;&#x65F6;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x63E1;&#x624B;&#x64CD;&#x4F5C;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x4FDD;&#x6301;&#x4E00;&#x4E2A;&#x957F;&#x8FDE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48; TCP &#x534F;&#x8BAE;&#x672C;&#x8EAB;&#x5C06;&#x4F1A;&#x8282;&#x7701;&#x5F88;&#x591A;TCP&#x63E1;&#x624B;&#x65F6;&#x95F4;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x771F;&#x7684;&#x91CD;&#x65B0;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;&#x4EE3;&#x4EF7;&#x4E5F;&#x76F8;&#x5F53;&#x5C0F;&#x3002;</p>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x548C;&#x591A;&#x4E2A; broker &#x4E4B;&#x95F4;&#x4FDD;&#x6301;&#x8FDE;&#x63A5;&#xFF0C;&#x56E0;&#x4E3A;&#x6570;&#x636E;&#x662F;&#x88AB;&#x5206;&#x533A;&#x7684;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x548C;&#x5BF9;&#x5E94;&#x6570;&#x636E;&#x6240;&#x5728;&#x7684; broker &#x4EA4;&#x4E92;&#x3002;&#x4E00;&#x822C;&#x800C;&#x8A00;&#xFF0C;&#x5355;&#x4E2A; broker &#x548C;&#x5355;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x6CA1;&#x6709;&#x6BD4;&#x8F83;&#x4FDD;&#x6301;&#x591A;&#x4E2A;&#x8FDE;&#x63A5; &#xFF08;&#x4F8B;&#x5982; &#x8FDE;&#x63A5;&#x6C60;&#xFF09;</p>
<p>&#x670D;&#x52A1;&#x7AEF;&#x4FDD;&#x8BC1;&#x5355;&#x4E2A; TCP &#x8FDE;&#x63A5;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x987A;&#x5E8F;&#x548C;&#x6700;&#x7EC8;&#x54CD;&#x5E94;&#x7684;&#x987A;&#x5E8F;&#x7684;&#x4E00;&#x81F4;&#x7684;&#xFF0C;&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x5904;&#x7406;&#x987A;&#x5E8F;&#x4E00;&#x81F4;&#xFF0C;&#x5355;&#x4E2A;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x540C;&#x65F6;&#x53EA;&#x4F1A;&#x5904;&#x7406;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x6307;&#x4EE4;&#x3002;&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x975E;&#x963B;&#x585E;&#x65B9;&#x5F0F;&#x6765;&#x63D0;&#x5347;&#x541E;&#x5410;&#x91CF;&#x3002;&#x4E5F;&#x5C31;&#x8BF4;&#x5BA2;&#x6237;&#x7AEF;&#x5728;&#x7B49;&#x5F85;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x53D1;&#x9001;&#x4E0B;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#xFF0C;&#x56E0;&#x4E3A;&#x5F85;&#x5B8C;&#x6210;&#x7684;&#x8BF7;&#x6C42;&#x5C06;&#x4F1A;&#x5728;&#x5E95;&#x5C42;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5957;&#x63A5;&#x5B57;&#x7F13;&#x51B2;&#x533A;&#x8FDB;&#x884C;&#x7F13;&#x51B2;&#x3002;&#x9664;&#x975E;&#x7279;&#x522B;&#x8BF4;&#x660E;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8BF7;&#x6C42;&#x662F;&#x7531;&#x5BA2;&#x6237;&#x7AEF;&#x542F;&#x52A8;&#xFF0C;&#x5E76;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x83B7;&#x53D6;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x54CD;&#x5E94;&#x6D88;&#x606F;&#x3002;</p>
<p>&#x670D;&#x52A1;&#x5668;&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x8BF7;&#x6C42;&#x5927;&#x5C0F;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x5982;&#x679C;&#x8D85;&#x8FC7;&#x5927;&#x5C0F;&#x9650;&#x5236;&#x8FDE;&#x63A5;&#x5C06;&#x65AD;&#x5F00;</p>
<h4 id="&#x5206;&#x533A;&#x4E0E;&#x5F15;&#x5BFC;">&#x5206;&#x533A;&#x4E0E;&#x5F15;&#x5BFC;</h4>
<p>Kafka &#x662F;&#x4E00;&#x4E2A;&#x5206;&#x533A;&#x7CFB;&#x7EDF;&#xFF0C;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4E2D;&#x62E5;&#x6709;&#x5168;&#x90E8;&#x7684;&#x6570;&#x636E;&#x96C6;&#x5408;&#x3002;topic &#x4F1A;&#x88AB;&#x5206;&#x4E3A; P&#xFF08;&#x521B;&#x5EFA;&#x5206;&#x533A;&#x9884;&#x5B9A;&#x4E49;&#x597D;&#x7684;&#xFF09; &#x4E2A;&#x5206;A&#x533A;, &#x6BCF;&#x4E2A;&#x5206;&#x533A;&#x7684;&#x590D;&#x5236;&#x56E0;&#x5B50;&#x662F; N&#xFF0C; Topic Partition&#x6839;&#x636E;&#x987A;&#x5E8F;&#x5728;&#x201C;&#x63D0;&#x4EA4;&#x65E5;&#x5FD7;&#x201D;&#x4E2D;&#x7F16;&#x53F7;&#x4E3A;0&#xFF0C;1&#xFF0C;&#x2026;&#xFF0C;P&#x3002;</p>
<p>&#x6240;&#x6709;&#x5177;&#x5907;&#x8BE5;&#x7279;&#x6027;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x90FD;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x5982;&#x4F55;&#x5C06;&#x6307;&#x5B9A;&#x7684;&#x6570;&#x636E;&#x5206;&#x914D;&#x5230;&#x6307;&#x5B9A;&#x5206;&#x533A;&#x4E2D;&#x7684;&#x95EE;&#x9898;&#x3002;Kafka &#x5BA2;&#x6237;&#x7AEF;&#x76F4;&#x63A5;&#x63A7;&#x5236;&#x5206;&#x914D;&#xFF0C;broker &#x81EA;&#x5DF1;&#x6CA1;&#x6709;&#x7279;&#x522B;&#x7684;&#x8BED;&#x4E49;&#x6765;&#x51B3;&#x5B9A;&#x5206;&#x914D;&#x5230;&#x90A3;&#x4E2A;&#x5206;&#x533A;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x751F;&#x4EA7;&#x8005;&#x76F4;&#x63A5;&#x5C06;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x5230;&#x6307;&#x5B9A;&#x7684;&#x5206;&#x533A;&#x5E76;&#x4E14;&#x5728;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x4E5F;&#x8981;&#x4ECE;&#x5236;&#x5B9A;&#x5206;&#x533A;&#x4E2D;&#x8BFB;&#x53D6;&#x3002;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x4E2A;&#x5206;&#x533A;&#x63CF;&#x8FF0;&#xFF0C;&#x90A3;&#x4E48;&#x4ED6;&#x4EEC;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x65B9;&#x5F0F;&#x8BA1;&#x7B97;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x548C;&#x5BF9;&#x5E94;&#x5206;&#x533A;&#x7684;&#x6620;&#x5C04;</p>
<p>&#x751F;&#x4EA7;&#x6D88;&#x606F;&#x6216;&#x8005;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x8BF7;&#x6C42;&#x5FC5;&#x987B;&#x53D1;&#x9001;&#x5230;&#x5F53;&#x524D;&#x7ED9;&#x5B9A;&#x5206;&#x533A; leader &#x89D2;&#x8272;&#x7684; broker &#x8282;&#x70B9;&#x4E0A;&#x3002;&#x8FD9;&#x4E2A;&#x662F; broker &#x5F3A;&#x5236;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x5230;&#x4E00;&#x4E2A;&#x5206;&#x533A;&#x9519;&#x8BEF;&#x7684; broker &#x8282;&#x70B9;&#x662F;&#x5C06;&#x4F1A;&#x54CD;&#x5E94; <code>NotLeaderForPartition</code> &#x9519;&#x8BEF;&#x7801;(&#x4E0B;&#x9762;&#x4F1A;&#x63CF;&#x8FF0;)</p>
<p>&#x5982;&#x4F55;&#x77E5;&#x9053;&#x73B0;&#x6709;&#x5B58;&#x5728;&#x7684; topic&#xFF0C; &#x5B83;&#x4EEC;&#x5B58;&#x5728;&#x7684;&#x5206;&#x533A;&#x6570;&#xFF0C;&#x4EE5;&#x53CA;&#x5F53;&#x524D;&#x5206;&#x533A;&#x5BF9;&#x5E94;&#x7684; broker, &#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5C06;&#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x5230;&#x6B63;&#x786E;&#x7684; broker &#x8282;&#x70B9;&#xFF1F;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x90FD;&#x662F;&#x52A8;&#x6001;&#x53D8;&#x5316;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x7B80;&#x5355;&#x7684;&#x914D;&#x7F6E;&#x5230;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x6620;&#x5C04;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x3002;&#x6240;&#x6709;&#x7684; kafka broker &#x8282;&#x70B9;&#x63D0;&#x4F9B;&#x83B7;&#x53D6; meta &#x6570;&#x636E;&#x8BF7;&#x6C42;&#x63A5;&#x53E3;&#xFF0C;&#x8FD4;&#x56DE;&#x63CF;&#x8FF0;&#x5F53;&#x524D;&#x96C6;&#x7FA4;&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;: &#x5B58;&#x5728;&#x7684;&#x6240;&#x6709; topic&#x3001;&#x6BCF;&#x4E2A; topic &#x5206;&#x533A;&#x4FE1;&#x606F;&#x3001;&#x6BCF;&#x4E2A;&#x5206;&#x533A;&#x5BF9;&#x5E94;&#x7684; leader &#x8282;&#x70B9;&#x4EE5;&#x53CA; broker &#x8282;&#x70B9;&#x7684;ip&#x548C;&#x7AEF;&#x53E3;&#x4FE1;&#x606F;</p>
<p>&#x6362;&#x53E5;&#x8BDD;&#x5C31;&#x662F;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x5176;&#x4E2D;&#x4E00;&#x4E2A; broker &#x6765;&#x83B7;&#x53D6;&#x6240;&#x6709;&#x5B58;&#x5728;&#x7684; broker &#x4FE1;&#x606F;&#x4EE5;&#x53CA;&#x5206;&#x533A;&#x4FE1;&#x606F;&#x3002;&#x7B2C;&#x4E00;&#x4E2A; broker &#x53EF;&#x80FD;&#x81EA;&#x5DF1;&#x4F1A;&#x6302;&#x6389;&#xFF0C;&#x6240;&#x4EE5;&#x6700;&#x597D;&#x7684;&#x5B9E;&#x8DF5;&#x65B9;&#x6848;&#x662F;&#x91C7;&#x7528;&#x4E00;&#x4E2A; broker &#x5217;&#x8868;&#x6765;&#x542F;&#x52A8;&#x3002;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x4E2D;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x4F7F;&#x7528;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x6216;&#x8005;&#x9759;&#x6001;&#x7684;&#x914D;&#x7F6E;&#x4E24;&#x4E2A;&#x6216;&#x4E09;&#x4E2A; host </p>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x4E0D;&#x9700;&#x8981;&#x4FDD;&#x6301;&#x8F6E;&#x8BE2;&#x7684;&#x65B9;&#x5F0F;&#x67E5;&#x770B;&#x96C6;&#x7FA4;&#x662F;&#x5426;&#x53D8;&#x66F4;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6; meta &#x4FE1;&#x606F;&#x5E76;&#x4E14;&#x505A;&#x597D;&#x7F13;&#x5B58;&#xFF0C;&#x77E5;&#x9053;&#x63A5;&#x6536;&#x5230;&#x9519;&#x8BEF;&#x6216;&#x8005; meta &#x7F13;&#x5B58;&#x4FE1;&#x606F;&#x8FC7;&#x671F;&#x662F;&#x53BB;&#x518D;&#x6B21;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x4FE1;&#x606F;&#x3002;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x4E00;&#x822C;&#x5728;&#x4E0B;&#x9762;&#x51E0;&#x79CD;&#x5F62;&#x5F0F;&#x4E0B;&#x4F1A;&#x53D1;&#x751F;&#xFF1A;</p>
<ul>
<li>&#x8FDE;&#x63A5;&#x9519;&#x8BEF;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x65E0;&#x6CD5;&#x4E0E;&#x6307;&#x5B9A;&#x7684; broker &#x4EA4;&#x4E92;</li>
<li>&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x9519;&#x8BEF;&#xFF0C;&#x8BE5;broker &#x4E0D;&#x5728;&#x662F;&#x8BF7;&#x6C42;&#x4E2D;&#x6307;&#x5B9A;&#x5206;&#x533A;&#x7684; leader broker</li>
</ul>
<p>&#x901A;&#x8FC7;&#x5FAA;&#x73AF; bootstrap &#x5730;&#x5740;&#xFF0C;&#x77E5;&#x9053;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x8FDE;&#x63A5;&#x7684;&#x5E76;&#x4E14;&#x83B7;&#x53D6;&#x96C6;&#x7FA4;&#x7684; meta &#x4FE1;&#x606F;, &#x5904;&#x7406;&#x6D88;&#x8D39;&#x6216;&#x8005;&#x751F;&#x4EA7;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x8FC7; topic &#x548C;&#x5206;&#x533A;&#x4FE1;&#x606F;&#x786E;&#x5B9A;&#x5408;&#x9002;&#x7684;&#x4EA4;&#x4E92; broker &#x8FDB;&#x884C;&#x751F;&#x4EA7;&#x548C;&#x6D88;&#x8D39;, &#x5982;&#x679C;&#x83B7;&#x53D6;&#x5230;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x91CD;&#x65B0;&#x5237;&#x65B0; meta &#x4FE1;&#x606F;</p>
<h4 id="&#x5206;&#x533A;&#x7B56;&#x7565;">&#x5206;&#x533A;&#x7B56;&#x7565;</h4>
<p>&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x5206;&#x914D;&#x6D88;&#x606F;&#x5230;&#x5206;&#x533A;&#x5728;&#x751F;&#x4EA7;&#x5BA2;&#x6237;&#x7AEF;&#x63A7;&#x5236;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x5E76;&#x4E14;&#x66B4;&#x9732;&#x7ED9;&#x6700;&#x7EC8;&#x7528;&#x6237;&#xFF1F;</p>
<p>&#x5206;&#x533A;&#x5B9E;&#x9645;&#x4E0A;&#x5728; Kafka &#x4E2D;&#x6709;&#x4E24;&#x4E2A;&#x76EE;&#x7684;&#xFF1A;</p>
<ul>
<li>&#x5747;&#x8861; broker &#x8282;&#x70B9;&#x7684;&#x6570;&#x636E;&#x548C;&#x8BF7;&#x6C42;&#x8D1F;&#x8F7D;</li>
<li>&#x5B83;&#x5141;&#x8BB8;&#x591A;&#x4E2A;&#x6D88;&#x8D39;&#x8005;&#x4E4B;&#x95F4;&#x5904;&#x7406;&#x5206;&#x53D1;&#x6D88;&#x606F;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x80FD;&#x591F;&#x7EF4;&#x62A4;&#x672C;&#x5730;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x5206;&#x533A;&#x4E2D;&#x7EF4;&#x6301;&#x6D88;&#x606F;&#x7684;&#x987A;&#x5E8F;&#x3002;&#x6211;&#x4EEC;&#x79F0;&#x8FD9;&#x79CD;&#x8BED;&#x4E49;&#x7684;&#x5206;&#x533A;&#xFF08;semantic partitioning&#xFF09;&#x3002;</li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x7ED9;&#x5B9A;&#x7684;&#x4F7F;&#x7528;&#x573A;&#x666F;&#x4E0B;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x53EA;&#x5173;&#x5FC3;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6216;&#x4E24;&#x4E2A;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x7B80;&#x5355;&#x7684;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#xFF0C;&#x5BF9;&#x4E8E;&#x5BA2;&#x6237;&#x7AEF;&#x6765;&#x8BF4;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7B56;&#x7565;&#x5C31;&#x662F;&#x8F6E;&#x8BE2;&#x8BF7;&#x6C42;&#x6240;&#x6709;&#x7684; broker. &#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x9009;&#x62E9;&#xFF0C;&#x5728;&#x751F;&#x4EA7;&#x8005;&#x5927;&#x4E8E; broker &#x8282;&#x70B9;&#x7684;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x7ED9;&#x6BCF;&#x4E2A;&#x5BA2;&#x6237;&#x673A;&#x968F;&#x673A;&#x9009;&#x62E9;&#x5E76;&#x53D1;&#x5E03;&#x6D88;&#x606F;&#x5230;&#x8BE5;&#x5206;&#x533A;, &#x540E;&#x8005;&#x7684;&#x7B56;&#x7565;&#x53EF;&#x4EE5;&#x51CF;&#x5C11; TCP &#x8FDE;&#x63A5;</p>
<p>&#x8BED;&#x4E49;&#x5206;&#x533A;&#x662F;&#x6307;&#x4F7F;&#x7528;&#x5173;&#x952E;&#x5B57;&#x6765;&#x51B3;&#x5B9A;&#x6D88;&#x606F;&#x5206;&#x914D;&#x7684;&#x5206;&#x533A;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x6B63;&#x5728;&#x5904;&#x7406;&#x4E00;&#x4E2A;&#x70B9;&#x51FB;&#x6D88;&#x606F;&#x6D41;&#x65F6;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x7528;&#x6237; ID &#x5206;&#x6D41;&#xFF0C;&#x4F7F;&#x5F97;&#x7279;&#x5B9A;&#x7528;&#x6237;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x88AB;&#x5355;&#x4E2A;&#x6D88;&#x8D39;&#x8005;&#x6D88;&#x8D39;&#x3002;&#x8981;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x91C7;&#x53D6;&#x4E0E;&#x6D88;&#x606F;&#x5173;&#x8054;&#x7684;&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x5173;&#x952E;&#x5B57;&#x7684;&#x67D0;&#x4E2A; hash &#x503C;&#x6765;&#x9009;&#x62E9;&#x4F20;&#x9001;&#x7684;&#x5206;&#x533A;</p>
<h4 id="&#x6279;&#x91CF;">&#x6279;&#x91CF;</h4>
<p>Our apis encourage batching small things together for efficiency. We have found this is a very significant performance win. Both our API to send messages and our API to fetch messages always work with a sequence of messages not a single message to encourage this. A clever client can make use of this and support an &quot;asynchronous&quot; mode in which it batches together messages sent individually and sends them in larger clumps. We go even further with this and allow the batching across multiple topics and partitions, so a produce request may contain data to append to many partitions and a fetch request may pull data from many partitions all at once.
The client implementer can choose to ignore this and send everything one at a time if they like.</p>
<h4 id="&#x7248;&#x672C;&#x4E0E;&#x517C;&#x5BB9;&#x6027;">&#x7248;&#x672C;&#x4E0E;&#x517C;&#x5BB9;&#x6027;</h4>
<p>The protocol is designed to enable incremental evolution in a backward compatible fashion. Our versioning is on a per-api basis, each version consisting of a request and response pair. Each request contains an API key that identifies the API being invoked and a version number that indicates the format of the request and the expected format of the response.
The intention is that clients would implement a particular version of the protocol, and indicate this version in their requests. Our goal is primarily to allow API evolution in an environment where downtime is not allowed and clients and servers cannot all be changed at once.
The server will reject requests with a version it does not support, and will always respond to the client with exactly the protocol format it expects based on the version it included in its request. The intended upgrade path is that new features would first be rolled out on the server (with the older clients not making use of them) and then as newer clients are deployed these new features would gradually be taken advantage of.
Currently all versions are baselined at 0, as we evolve these APIs we will indicate the format for each version individually.</p>
<h3 id="&#x534F;&#x8BAE;">&#x534F;&#x8BAE;</h3>
<h4 id="&#x534F;&#x8BAE;&#x539F;&#x59CB;&#x7C7B;&#x578B;">&#x534F;&#x8BAE;&#x539F;&#x59CB;&#x7C7B;&#x578B;</h4>
<h4 id="&#x8BF7;&#x6C42;&#x8BED;&#x6CD5;&#x8981;&#x70B9;">&#x8BF7;&#x6C42;&#x8BED;&#x6CD5;&#x8981;&#x70B9;</h4>
<h4 id="&#x901A;&#x7528;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x7ED3;&#x6784;">&#x901A;&#x7528;&#x8BF7;&#x6C42;&#x54CD;&#x5E94;&#x7ED3;&#x6784;</h4>
<h5 id="&#x8BF7;&#x6C42;">&#x8BF7;&#x6C42;</h5>
<h5 id="&#x54CD;&#x5E94;">&#x54CD;&#x5E94;</h5>
<h5 id="&#x6D88;&#x606F;&#x96C6;&#x5408;">&#x6D88;&#x606F;&#x96C6;&#x5408;</h5>
<h5 id="&#x538B;&#x7F29;">&#x538B;&#x7F29;</h5>
<h4 id="api">API</h4>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Introduction"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
